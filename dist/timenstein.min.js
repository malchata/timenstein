var Timenstein=function(){"use strict";var e="[Timenstein] Can't continue because the required performance APIs are not supported in this browser.",r="[Timenstein] Can't create a performance mark because a handle wasn't given for it.";return function(n,t){var i,a,s,o,u={},m={},c=!1,f=t&&"mark"in t&&"measure"in t&&"getEntriesByName"in t&&"clearMarks"in t&&"clearMeasures"in t&&"PerformanceObserver"in n,p=function(e,r){return e>=1&&e<=r},l=function(e){return e.split("-")[0]},g=function(e){return"toJSON"in n.PerformanceEntry.prototype?e.toJSON():JSON.parse(JSON.stringify(e))},v=function(e){i&&console[a](e)};function Timenstein(r){return f?(c=!0,i=(r=r||{}).errorLogging||!0,a=/^(log|warn|error)$/.test(r.errorLogLevel)?r.errorLogLevel:"warn",s=r.namespace||"timenstein",o=r.namespaceDelimiter||"::",new PerformanceObserver((function(e){e.getEntries().forEach((function(e){var r=e.name,n=e.entryType;if(0===r.indexOf(""+s+o)){if("mark"===n){var i=g(e),a=l(r),c=r.split("-")[1];i.segmentNumber=c,u[a].entries.push(i)}var f,p,v;if("measure"===n){var h=l(r),d=[(v=r.split("-"))[1],v[2]],T=g(e);T.startSegment=d[0],T.endSegment=d[1],T.resources=(f=e.startTime,p=e.startTime+e.duration,t.getEntriesByType("resource").filter((function(e){return e.startTime>=f&&e.responseEnd<=p})).map((function(e){return g(e)}))),m[h].entries.push(T)}}}))})).observe({entryTypes:["mark","measure"]})):v(e),c}return Timenstein.prototype.mark=function(n,i){if(!c)return v(e),c;if(!n)return v(r),!1;if(n.indexOf(o)>-1)return v("[Timenstein] The given handle contains the namespace delimiter."),!1;var a,m=""+s+o+n;if(m in u&&u[m].locked)return v("[Timenstein] Can't create a performance mark for the given handle because it is locked."),!1;m in u?a=u[m].entries.length+1:(a=1,u[m]={locked:!1,entries:[]});var f=m+"-"+a;return t.mark(f),i&&(u[m].locked=!0),!0},Timenstein.prototype.measure=function(n,i,a){if(!c)return v(e),c;if(!n)return v(r),!1;var f=""+s+o+n;if(!(f in u))return v("[Timenstein] The given handle doesn't have any marks associated with it."),!1;var l=u[f].entries.length;if(l<2)return v("[Timenstein] The given handle must have at least two associated marks in order to make a measurement"),!1;if(!((i=i||1)<(a=a||l)&&a>i&&p(i,l)&&p(a,l)))return v("[Timenstein] The given measurement range is not valid for the handle given."),!1;f in m||(m[f]={entries:[]});var g=f+"-"+i+"-"+a,h=f+"-"+i,d=f+"-"+a;return t.measure(g,h,d),!0},Timenstein.prototype.clear=function(r,n){if(!c)return v(e),c;if(!/^m(arks|easures)$/i.test(r))return v('[Timenstein] When invoking the `clear` method, its sole argument must either be "marks" or "measures".'),!1;var i=r.substr(0,r.length-1);return t.getEntries().forEach((function(e){var a=e.name,u=e.entryType===i&&0===a.indexOf(""+s+o);n instanceof RegExp&&(u=u&&n.test(a)),u&&t["clear"+(r[0].toUpperCase()+r.slice(1))](a)})),!0},Timenstein.prototype.getMarks=function(){return u},Timenstein.prototype.getMeasures=function(){return m},Timenstein}(window,window.performance)}();
